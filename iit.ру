import requests

def text_to_speech(text, output_file="audio.mp3", api_key=None):
    """
    Озвучивает текст с помощью Yandex SpeechKit
    """
    url = 'https://tts.api.cloud.yandex.net/speech/v1/tts:synthesize'
    headers = {'Authorization': f'Api-Key {api_key}'}

    data = {
        'text': text,
        'lang': 'ru-RU',
        'voice': 'alena',        # можно: jane, omazh, filipp, ermil
        'format': 'mp3',
        'speed': '1.0'
    }

    response = requests.post(url, headers=headers, data=data, stream=True)
    if response.status_code == 200:
        with open(output_file, 'wb') as f:
            f.write(response.content)
        return output_file
    else:
        raise Exception(f"TTS error {response.status_code}: {response.text}")
